function checkWebpSupport(){return new Promise(((e,t)=>{let n=new Image;n.onload=function(){e(document.querySelector("body").classList.add("webp"))},n.onerror=function(){t(document.querySelector("body").classList.remove("webp"))},n.src="../img/check-webp/check.webp"}))}function getCoords(e){const t=e.getBoundingClientRect();return{top:t.top,left:t.left}}function toggleBody(e,t,n=null){n||(n=767);const r=window.matchMedia(`(max-width: ${n}px)`),o=t.offsetHeight;function i(){r.matches?(a(),e.addEventListener("click",l)):(e.removeEventListener("click",l),s())}function l(){e.classList.contains("__active")?a():s()}function s(){e.classList.add("__active"),t.style.maxHeight=2*o+"px",t.style.removeProperty("padding")}function a(){e.classList.remove("__active"),t.style.cssText="\n        max-height: 0px;\n        padding: 0px;\n    "}i(),r.addEventListener("change",i)}checkWebpSupport();class Header{constructor(){this.header=document.querySelector(".header"),this.toggleMenu()}toggleMenu(){toggleBody(this.header.querySelector(".burger"),this.header.querySelector(".header__main"),767)}}const header=new Header,mainSlider=new Swiper(".main-slider",{pagination:{el:".main-slider__pagination",type:"bullets",clickable:!0},autoplay:{delay:7500},speed:0,allowTouchMove:!1}),consumerSlider=new Swiper(".consumer-info__slider",{speed:0,allowTouchMove:!1});function initPagination(){function e(e,t){e.forEach((e=>e.classList.remove("__active"))),t.classList.add("__active")}document.querySelectorAll(".consumer-info").forEach((t=>{const n=t.querySelectorAll(".consumer-info__pagination-button"),r=t.querySelector(".consumer-info__slider"),o=Array.from(r.querySelectorAll(".consumer-info__slide"));let i=consumerSlider;if(consumerSlider.length>0)for(let e=0;e<consumerSlider.length;e++){const t=consumerSlider[e];t.el===r&&(i=t)}!function(t,n,r){const o=0,i=n[o];t[o];r.slideTo(o),e(n,i)}(o,n,i);const l=[];for(let e=0;e<n.length;e++){const t=e,r={btn:n[e],slide:o[e],slideIndex:t};l.push(r)}l.forEach((t=>{t.btn.addEventListener("click",(()=>{t.btn&&t.slide&&(i.slideTo(t.slideIndex),e(n,t.btn))}))}))}))}function catalogueHoverInit(){document.querySelectorAll(".catalogue-item").forEach((e=>{const t=e.querySelector(".catalogue-item__image"),n=document.createElement("div");n.className="catalogue-item__hover",n.innerHTML='\n            <button class="catalogue-item__hover-button button">\n                В корзину\n            </button>\n            <div class="catalogue-item__hover-option">\n                Добавить к сравнению \n            </div>\n        ',t.append(n),t.addEventListener("mouseover",(()=>t.querySelector(".catalogue-item__hover").classList.add("__active"))),t.addEventListener("mouseleave",(()=>t.querySelector(".catalogue-item__hover").classList.remove("__active")))}))}initPagination(),catalogueHoverInit();class Range{constructor(){const e=document.querySelectorAll(".range");e.length>0&&e.forEach((e=>{this.initRange(e)}))}initRange(e){const t=e.querySelector(".range__wrapper"),n=e.querySelector(".range__bar"),r=e.querySelector(".range__scale"),o=e.querySelector(".range__circle--min"),i=e.querySelector(".range__circle--max");e.querySelector(".range__min"),e.querySelector(".range__max");s=s.bind(this);let l=n.offsetWidth-i.offsetWidth;function s(){l=n.offsetWidth-i.offsetWidth,o.style.left="0px",i.style.left=`${l}px`,this.drawScale(r,o,i),this.setValues(e,l),this.drawScale(r,o,i),this.setValues(e,l)}function a(n){if(n.preventDefault(),n.target!=o&&n.target!=i){let e=n.clientX-getCoords(t).left;const r=this.nearestCircle(e,o,i);e=this.checkIfOutsideBar(e,l,o),r.style.left=e-o.offsetWidth/2+"px"}if(n.target==o||n.target==i){function s(s){let c=s.clientX-getCoords(t).left;c=parseInt(this.checkIfOutsideBar(c,l,o))-n.target.offsetWidth/2,n.target==o&&c>=parseInt(getComputedStyle(i).left)&&(c=`${parseInt(getComputedStyle(i).left)}px`),n.target==i&&c<=parseInt(getComputedStyle(o).left)&&(c=`${parseInt(getComputedStyle(o).left)}px`),a(c),this.drawScale(r,o,i),this.setValues(e,l)}function a(e){n.target.style.left=`${e}px`}s=s.bind(this),n.target.ondragstart=function(){return!1},document.addEventListener("pointermove",s),document.addEventListener("pointerup",(()=>{document.removeEventListener("pointermove",s),t.onpointerup=null}))}this.drawScale(r,o,i),this.setValues(e,l),t.onpointerup=null}s(),window.addEventListener("resize",s),a=a.bind(this),t.addEventListener("pointerdown",a)}checkIfOutsideBar(e,t,n){const r=n.offsetWidth/2;return e>t?t+r:e<n.offsetWidth/2?r:e>=r&&e<=t?e:void 0}nearestCircle(e,t,n){const r=parseInt(getComputedStyle(t).left),o=parseInt(getComputedStyle(n).left);return Math.abs(e-r)<Math.abs(e-o)?t:Math.abs(e-r)>Math.abs(e-o)?n:void 0}drawScale(e,t,n){const r=parseInt(getComputedStyle(n).left)-parseInt(getComputedStyle(t).left);e.style.cssText=`\n            position: absolute;\n            top: 0;\n            width: ${r}px;\n            left: ${getComputedStyle(t).left};\n        `}moveAt(e,t){e.style.left=t-e/2+"px"}setValues(e,t){const n=e.dataset.rangeBorders.split(", "),r=parseInt(n[0]),o=(parseInt(n[1])-r)/t,i=parseInt(getComputedStyle(e.querySelector(".range__circle--min")).left),l=parseInt(getComputedStyle(e.querySelector(".range__circle--max")).left),s=Math.round(o*i),a=Math.round(o*l),c=e.querySelector(".range__min").querySelector("span"),u=e.querySelector(".range__max").querySelector("span");c.innerHTML=s,u.innerHTML=a}}class Filter{constructor(){this.initRanges(),this.filterToggle()}initRanges(){new Range}filterToggle(){const e=document.querySelector(".filter");if(e){const t=e.querySelector(".filter__title"),n=e.querySelector(".filter__body");let r=e.dataset.hideFilterMedia;parseInt(r)||(r=859),toggleBody(t,n,859)}}}const filter=new Filter;