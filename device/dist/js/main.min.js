function checkWebpSupport(){return new Promise(((e,t)=>{let n=new Image;n.onload=function(){e(document.querySelector("body").classList.add("webp"))},n.onerror=function(){t(document.querySelector("body").classList.remove("webp"))},n.src="../img/check-webp/check.webp"}))}checkWebpSupport();const swiperLoad=new Promise((e=>{setTimeout((()=>{const t=document.createElement("script");t.src="../js/swiper-bundle.min.js",document.body.append(t),setTimeout((()=>{e()}),500)}),1e3)}));function getCoords(e){const t=e.getBoundingClientRect();return{top:t.top,left:t.left}}function toggleBody(e,t,n=null){n||(n=767);const o=window.matchMedia(`(max-width: ${n}px)`),r=t.offsetHeight;function s(){o.matches?(a(),e.addEventListener("click",i)):(e.removeEventListener("click",i),c())}function i(){e.classList.contains("__active")?a():c()}function c(){e.classList.add("__active"),t.style.maxHeight=2*r+"px",t.style.removeProperty("padding")}function a(){e.classList.remove("__active"),t.style.cssText="\n        max-height: 0px;\n        padding: 0px;\n    "}s(),o.addEventListener("change",s)}function deferredMapsLoading(){const e=document.querySelector("#map");if(!e)return;const t=new IntersectionObserver((r=>{const s=r[0];(s.boundingClientRect.top<=document.documentElement.offsetHeight||window.offsetHeight||s.isIntersecting)&&!o&&(!function(){const t=document.createElement("iframe");console.log(t),t.src="https://yandex.ru/map-widget/v1/?um=constructor%3Aac473187741f5d897b5dc10b78069cc6f6aea0f00ad658742fb27e942ee63ca2&amp;source=constructor",t.frameborder="0",e.append(t)}(),o=!0,t.unobserve(n))}),{threshold:1}),n=document.querySelector("#intersection-load-maps");let o=!1;t.observe(n)}swiperLoad.then((()=>{new Swiper(".main-slider",{pagination:{el:".main-slider__pagination",type:"bullets",clickable:!0},autoplay:{delay:7500},speed:0,allowTouchMove:!1});const e=new Swiper(".consumer-info__slider",{speed:0,allowTouchMove:!1});!function(){function t(e,t){e.forEach((e=>e.classList.remove("__active"))),t.classList.add("__active")}document.querySelectorAll(".consumer-info").forEach((n=>{const o=n.querySelectorAll(".consumer-info__pagination-button"),r=n.querySelector(".consumer-info__slider"),s=Array.from(r.querySelectorAll(".consumer-info__slide"));let i=e;if(e.length>0)for(let t=0;t<e.length;t++){const n=e[t];n.el===r&&(i=n)}!function(e,n,o){const r=0,s=n[r];e[r];o.slideTo(r),t(n,s)}(s,o,i);const c=[];for(let e=0;e<o.length;e++){const t=e,n={btn:o[e],slide:s[e],slideIndex:t};c.push(n)}c.forEach((e=>{e.btn.addEventListener("click",(()=>{e.btn&&e.slide&&(i.slideTo(e.slideIndex),t(o,e.btn))}))}))}))}()})),deferredMapsLoading();class Header{constructor(){this.header=document.querySelector(".header"),this.toggleMenu()}toggleMenu(){toggleBody(this.header.querySelector(".burger"),this.header.querySelector(".header__main"),767)}}const header=new Header;function catalogueHoverInit(){document.querySelectorAll(".catalogue-item").forEach((e=>{const t=e.querySelector(".catalogue-item__image"),n=document.createElement("div");n.className="catalogue-item__hover",n.innerHTML='\n            <button class="catalogue-item__hover-button button">\n                В корзину\n            </button>\n            <div class="catalogue-item__hover-option">\n                Добавить к сравнению \n            </div>\n        ',t.append(n),t.addEventListener("mouseover",(()=>t.querySelector(".catalogue-item__hover").classList.add("__active"))),t.addEventListener("mouseleave",(()=>t.querySelector(".catalogue-item__hover").classList.remove("__active")))}))}catalogueHoverInit();class Range{constructor(){const e=document.querySelectorAll(".range");e.length>0&&e.forEach((e=>{this.initRange(e)}))}initRange(e){const t=e.querySelector(".range__wrapper"),n=e.querySelector(".range__bar"),o=e.querySelector(".range__scale"),r=e.querySelector(".range__circle--min"),s=e.querySelector(".range__circle--max");e.querySelector(".range__min"),e.querySelector(".range__max");c=c.bind(this);let i=n.offsetWidth-s.offsetWidth;function c(){i=n.offsetWidth-s.offsetWidth,r.style.left="0px",s.style.left=`${i}px`,this.drawScale(o,r,s),this.setValues(e,i),this.drawScale(o,r,s),this.setValues(e,i)}function a(n){if(n.preventDefault(),n.target!=r&&n.target!=s){let e=n.clientX-getCoords(t).left;const o=this.nearestCircle(e,r,s);e=this.checkIfOutsideBar(e,i,r),o.style.left=e-r.offsetWidth/2+"px"}if(n.target==r||n.target==s){function c(c){let l=c.clientX-getCoords(t).left;l=parseInt(this.checkIfOutsideBar(l,i,r))-n.target.offsetWidth/2,n.target==r&&l>=parseInt(getComputedStyle(s).left)&&(l=`${parseInt(getComputedStyle(s).left)}px`),n.target==s&&l<=parseInt(getComputedStyle(r).left)&&(l=`${parseInt(getComputedStyle(r).left)}px`),a(l),this.drawScale(o,r,s),this.setValues(e,i)}function a(e){n.target.style.left=`${e}px`}c=c.bind(this),n.target.ondragstart=function(){return!1},document.addEventListener("pointermove",c),document.addEventListener("pointerup",(()=>{document.removeEventListener("pointermove",c),t.onpointerup=null}))}this.drawScale(o,r,s),this.setValues(e,i),t.onpointerup=null}c(),window.addEventListener("resize",c),a=a.bind(this),t.addEventListener("pointerdown",a)}checkIfOutsideBar(e,t,n){const o=n.offsetWidth/2;return e>t?t+o:e<n.offsetWidth/2?o:e>=o&&e<=t?e:void 0}nearestCircle(e,t,n){const o=parseInt(getComputedStyle(t).left),r=parseInt(getComputedStyle(n).left);return Math.abs(e-o)<Math.abs(e-r)?t:Math.abs(e-o)>Math.abs(e-r)?n:void 0}drawScale(e,t,n){const o=parseInt(getComputedStyle(n).left)-parseInt(getComputedStyle(t).left);e.style.cssText=`\n            position: absolute;\n            top: 0;\n            width: ${o}px;\n            left: ${getComputedStyle(t).left};\n        `}moveAt(e,t){e.style.left=t-e/2+"px"}setValues(e,t){const n=e.dataset.rangeBorders.split(", "),o=parseInt(n[0]),r=(parseInt(n[1])-o)/t,s=parseInt(getComputedStyle(e.querySelector(".range__circle--min")).left),i=parseInt(getComputedStyle(e.querySelector(".range__circle--max")).left),c=Math.round(r*s),a=Math.round(r*i),l=e.querySelector(".range__min").querySelector("span"),d=e.querySelector(".range__max").querySelector("span");l.innerHTML=c,d.innerHTML=a}}class Filter{constructor(){this.initRanges(),this.filterToggle()}initRanges(){new Range}filterToggle(){const e=document.querySelector(".filter");if(e){const t=e.querySelector(".filter__title"),n=e.querySelector(".filter__body");let o=e.dataset.hideFilterMedia;parseInt(o)||(o=859),toggleBody(t,n,859)}}}const filter=new Filter;